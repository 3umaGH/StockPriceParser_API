const express = require("express");
const { getTickerPrice, fetchTickerPrices } = require("./util/util");
const cors = require("cors");
const app = express();

const tickerArray = [
  "EURUSD",
  "VWCE:FRA:EUR",
  "LLY:NYQ",
  /*"V:NYQ",
  "UNH:NYQ",
  "TSM:NYQ",
  "NVO:NYQ",
  "JPM:NYQ",
  "WMT:NYQ",
  "XOM:NYQ",
  "MA:NYQ",
  "JNJ:NYQ",
  "PG:NYQ",
  "ORCL:NYQ",
  "HD:NYQ",
  "CVX:NYQ",
  "MRK:NYQ",
  "KO:NYQ",
  "TM:NYQ",
  "ABBV:NYQ",
  "BAC:NYQ",
  "FMX:NYQ",
  "CRM:NYQ",
  "SHEL:NYQ",
  "ACN:NYQ",
  "MCD:NYQ",
  "NVS:NYQ",
  "BABA:NYQ",
  "TMO:NYQ",
  "SAP:NYQ",
  "ABT:NYQ",
  "PFE:NYQ",
  "DIS:NYQ",
  "NKE:NYQ",
  "TTE:NYQ",
  "DHR:NYQ",
  "VZ:NYQ",
  "BHP:NYQ",
  "WFC:NYQ",
  "HDB:NYQ",
  "HSBC:NYQ",
  "PM:NYQ",
  "IBM:NYQ",
  "NOW:NYQ",
  "COP:NYQ",
  "UNP:NYQ",
  "BA:NYQ",
  "GE:NYQ",
  "SPGI:NYQ",
  "BX:NYQ",
  "MS:NYQ",
  "UPS:NYQ",
  "CAT:NYQ",
  "AMAT:NSQ",
  "BUD:NYQ",
  "RY:NYQ",
  "UL:NYQ",
  "AXP:NYQ",
  "NEE:NYQ",
  "UBER:NYQ",
  "T:NYQ",
  "LOW:NYQ",
  "RTX:NYQ",
  "ELV:NYQ",
  "RIO:NYQ",
  "SYK:NYQ",
  "LMT:NYQ",
  "TD:NYQ",
  "GS:NYQ",
  "BLK:NYQ",
  "SONY:NYQ",
  "MDT:NYQ",
  "MUFG:NYQ",
  "DE:NYQ",
  "PLD:NYQ",
  "TJX:NYQ",
  "BP:NYQ",
  "BMY:NYQ",
  "SCHW:NYQ",
  "MMC:NYQ",
  "PBR:NYQ",
  "EQNR:NYQ",
  "PGR:NYQ",
  "SHOP:NYQ",
  "AMT:NYQ",
  "CB:NYQ",
  "ETN:NYQ",
  "CVS:NYQ",
  "C:NYQ",
  "UBS:NYQ",
  "CI:NYQ",
  "ZTS:NYQ",
  "BSX:NYQ",
  "DEO:NYQ",
  "KKR:NYQ",
  "IBN:NYQ",
  "SO:NYQ",
  "FI:NYQ",
  "SLB:NYQ",
  "CNI:NYQ",
  "MO:NYQ",
  "GSK:NYQ",
  "RELX:NYQ",
  "ITW:NYQ",
  "ENB:NYQ",
  "BTI:NYQ",
  "INFY:NYQ",
  "EOG:NYQ",
  "CNQ:NYQ",
  "NOC:NYQ",
  "SHW:NYQ",
  "DUK:NYQ",
  "BDX:NYQ",
  "WM:NYQ",
  "ANET:NYQ",
  "HCA:NYQ",
  "GD:NYQ",
  "RACE:NYQ",
  "SMFG:NYQ",
  "MCO:NYQ",
  "AON:NYQ",
  "CP:NYQ",
  "SAN:NYQ",
  "VALE:NYQ",
  "ICE:NYQ",
  "FDX:NYQ",
  "CL:NYQ",
  "TRI:NYQ",
  "HUM:NYQ",
  "STLA:NYQ",
  "MCK:NYQ",
  "CMG:NYQ",
  "ITUB:NYQ",
  "TGT:NYQ",
  "APD:NYQ",
  "EPD:NYQ",
  "BMO:NYQ",
  "USB:NYQ",
  "MPC:NYQ",
  "SNOW:NYQ",
  "AMX:NYQ",
  "BN:NYQ",
  "SCCO:NYQ",
  "PH:NYQ",
  "PXD:NYQ",
  "AJG:NYQ",
  "APH:NYQ",
  "TDG:NYQ",
  "BBVA:NYQ",
  "ECL:NYQ",
  "DELL:NYQ",
  "MMM:NYQ",
  "E:NYQ",
  "BNS:NYQ",
  "MSI:NYQ",
  "OXY:NYQ",
  "FCX:NYQ",
  "PSX:NYQ",
  "APO:NYQ",
  "TT:NYQ",
  "PNC:NYQ",
  "HMC:NYQ",
  "RSG:NYQ",
  "EMR:NYQ",
  "WELL:NYQ",
  "NSC:NYQ",
  "AFL:NYQ",
  "ING:NYQ",
  "NGG:NYQ",
  "AZO:NYQ",
  "CCI:NYQ",
  "MET:NYQ",
  "SRE:NYQ",
  "ET:NYQ",
  "BSBR:NYQ",
  "AIG:NYQ",
  "PCG:NYQ",
  "SPG:NYQ",
  "PSA:NYQ",
  "EL:NYQ",
  "MFG:NYQ",
  "HES:NYQ",
  "TAK:NYQ",
  "WMB:NYQ",
  "CRH:NYQ",
  "CARR:NYQ",
  "NEM:NYQ",
  "STZ:NYQ",
  "HLT:NYQ",
  "ABEV:NYQ",
  "VLO:NYQ",
  "TFC:NYQ",
  "DHI:NYQ",
  "SU:NYQ",
  "PLTR:NYQ",
  "MSCI:NYQ",
  "DLR:NYQ",
  "KMB:NYQ",
  "STM:NYQ",
  "F:NYQ",
  "EW:NYQ",
  "TEL:NYQ",
  "TRV:NYQ",
  "COF:NYQ",
  "COR:NYQ",
  "GWW:NYQ",
  "NUE:NYQ",
  "CNC:NYQ",
  "WDS:NYQ",
  "HLN:NYQ",
  "ADM:NYQ",
  "NU:NYQ",
  "D:NYQ",
  "OKE:NYQ",
  "GM:NYQ",
  "O:NYQ",
  "IQV:NYQ",
  "HSY:NYQ",
  "KVUE:NYQ",
  "KMI:NYQ",
  "TRP:NYQ",
  "SQ:NYQ",
  "LVS:NYQ",
  "GIS:NYQ",
  "A:NYQ",
  "SYY:NYQ",
  "MPLX:NYQ",
  "ALC:NYQ",
  "BK:NYQ",
  "DOW:NYQ",
  "CM:NYQ",
  "BCE:NYQ",
  "SPOT:NYQ",
  "LHX:NYQ",
  "YUM:NYQ",
  "ALL:NYQ",
  "AMP:NYQ",
  "LEN:NYQ",
  "JCI:NYQ",
  "AME:NYQ",
  "MFC:NYQ",
  "BBD:NYQ",
  "OTIS:NYQ",
  "WCN:NYQ",
  "PRU:NYQ",
  "FERG:NYQ",
  "HAL:NYQ",
  "IT:NYQ",
  "ARES:NYQ",
  "LYG:NYQ",
  "FIS:NYQ",
  "CVE:NYQ",
  "ORAN:NYQ",
  "CTVA:NYQ",
  "PPG:NYQ",
  "PEG:NYQ",
  "KR:NYQ",
  "CMI:NYQ",
  "PUK:NYQ",
  "URI:NYQ",
  "ROK:NYQ",
  "ED:NYQ",
  "QSR:NYQ",
  "DD:NYQ",
  "LYB:NYQ",
  "SLF:NYQ",
  "VICI:NYQ",
  "GPN:NYQ",
  "CHT:NYQ",
  "CPNG:NYQ",
  "GOLD:NYQ",
  "DVN:NYQ",
  "MLM:NYQ",
  "IR:NYQ",
  "ELP:NYQ",
  "HPQ:NYQ",
  "VEEV:NYQ",
  "VMC:NYQ",
  "EXR:NYQ",
  "DG:NYQ",
  "PKX:NYQ",
  "RCL:NYQ",
  "NTR:NYQ",
  "BCS:NYQ",
  "PWR:NYQ",
  "FICO:NYQ",
  "CAH:NYQ",
  "WST:NYQ",
  "EC:NYQ",
  "EFX:NYQ",
  "TU:NYQ",
  "WEC:NYQ",
  "AWK:NYQ",
  "EIX:NYQ",
  "NET:NYQ",
  "AEM:NYQ",
  "XYL:NYQ",
  "AVB:NYQ",
  "WIT:NYQ",
  "DB:NYQ",
  "RBLX:NYQ",
  "KEYS:NYQ",
  "CBRE:NYQ",
  "GLW:NYQ",
  "TEF:NYQ",
  "PDX:NYQ",
  "HUBS:NYQ",
  "ZBH:NYQ",
  "FTV:NYQ",
  "TLK:NYQ",
  "APTV:NYQ",
  "MTD:NYQ",
  "HIG:NYQ",
  "CHD:NYQ",
  "GIB:NYQ",
  "GRMN:NYQ",
  "WY:NYQ",
  "DAL:NYQ",
  "NWG:NYQ",
  "RMD:NYQ",
  "RCI:NYQ",
  "FNV:NYQ",
  "PINS:NYQ",
  "BR:NYQ",
  "RJF:NYQ",
  "STT:NYQ",
  "HWM:NYQ",
  "DTE:NYQ",
  "DFS:NYQ",
  "FE:NYQ",
  "EQR:NYQ",
  "MOH:NYQ",
  "ETR:NYQ",
  "WPM:NYQ",
  "IX:NYQ",
  "SE:NYQ",
  "BRO:NYQ",
  "HEI:NYQ",
  "WAB:NYQ",
  "SNAP:NYQ",
  "MTB:NYQ",
  "ES:NYQ",
  "MT:NYQ",
  "INVH:NYQ",
  "AEE:NYQ",
  "HPE:NYQ",
  "LYV:NYQ",
  "TS:NYQ",
  "STE:NYQ",
  "FTS:NYQ",
  "CTRA:NYQ",
  "TRGP:NYQ",
  "PHG:NYQ",
  "NVR:NYQ",
  "NOK:NYQ",
  "UMC:NYQ",
  "DOV:NYQ",
  "CCJ:NYQ",
  "ROL:NYQ",
  "BEKE:NYQ",
  "PPL:NYQ",
  "CCL:NYQ",
  "GPC:NYQ",
  "AMAT:NSQ",
  "CME:NSQ",
  "ADP:NSQ",
  "CSCO:NSQ",
  "CHTR:NSQ",
  "ISRG:NSQ",
  "KLAC:NSQ",
  "CDNS:NSQ",
  "INTU:NSQ",
  "DLTR:NSQ",
  "ODFL:NSQ",
  "TXN:NSQ",
  "REGN:NSQ",
  "KHC:NSQ",
  "MNST:NSQ",
  "BIDU:NSQ",
  "DASH:NSQ",
  "SGEN:NSQ",
  "AMGN:NSQ",
  "PYPL:NSQ",
  "MCHP:NSQ",
  "DDOG:NSQ",
  "HON:NSQ",
  "PDD:NSQ",
  "AMZN:NSQ",
  "MRVL:NSQ",
  "PAYX:NSQ",
  "LRCX:NSQ",
  "BKNG:NSQ",
  "ROP:NSQ",
  "COST:NSQ",
  "NTES:NSQ",
  "ABNB:NSQ",
  "AMD:NSQ",
  "AAPL:NSQ",
  "AEP:NSQ",
  "AZN:NSQ",
  "ARM:NSQ",
  "TMUS:NSQ",
  "VRTX:NSQ",
  "TSLA:NSQ",
  "MELI:NSQ",
  "QCOM:NSQ",
  "GILD:NSQ",
  "GOOGL:NSQ",
  "SNY:NSQ",
  "IMO:TOR",
  "LNG:ASQ",
  "CEG:NSQ",
  "CMCSA:NSQ",
  "ASML:NSQ",
  "TROW:NSQ",
  "WDAY:NSQ",
  "MSFT:NSQ",
  "PEP:NSQ",
  "ADI:NSQ",
  "ORLY:NSQ",
  "DXCM:NSQ",
  "CSX:NSQ",
  "SBUX:NSQ",
  "EA:NSQ",
  "ZS:NSQ",
  "CPRT:NSQ",
  "NVDA:NSQ",
  "AVGO:NSQ",
  "ADBE:NSQ",
  "TEAM:NSQ",
  "CRWD:NSQ",
  "LIN:NSQ",
  "ADSK:NSQ",
  "NFLX:NSQ",
  "NXPI:NSQ",
  "LULU:NSQ",
  "ICLR:NSQ",
  "INTC:NSQ",
  "BNTX:NSQ",
  "ROST:NSQ",
  "WTW:NSQ",
  "META:NSQ",
  "MDLZ:NSQ",
  "PANW:NSQ",
  "IDXX:NSQ",
  "EXC:NSQ",
  "SYM:LSE",
  "MRNA:NSQ",
  "JD:NSQ",
  "TSCO:NSQ",
  "COIN:NSQ",
  "MPWR:NSQ",
  "GEHC:NSQ",
  "MBLY:NSQ",
  "SBAC:NSQ",
  "BKR:NSQ",
  "CTSH:NSQ",
  "MDB:NMQ",
  "PCAR:NSQ",
  "XEL:NSQ",
  "IBKR:NSQ",
  "CDW:NSQ",
  "ULTA:NSQ",
  "VOD:NSQ",
  "ANSS:NSQ",
  "WBD:NSQ",
  "TTWO:NSQ",
  "SPLK:NSQ",
  "CQP:ASQ",
  "VRSN:NSQ",
  "MU:NSQ",
  "FANG:NSQ",
  "FCNCA:NSQ",
  "ARGX:NSQ",
  "CCEP:NSQ",
  "ALNY:NSQ",
  "CSGP:NSQ",
  "FTNT:NSQ",
  "FAST:NSQ",
  "BGNE:NSQ",
  "GFS:NSQ",
  "GMAB:NSQ",
  "NDAQ:NSQ",
  "ACGL:NSQ",
  "CTAS:NSQ",
  "VRSK:NSQ",
  "ZM:NSQ",
  "TTD:NMQ",
  "ON:NSQ",
  "TW:NSQ",
  "KDP:NSQ",
  "EQIX:NSQ",
  "SNPS:NSQ",
  "RYAAY:NSQ",
  "TCOM:NSQ",
  "EBAY:NSQ",
  "LI:NSQ",
  "MAR:NSQ",
  "BIIB:NSQ",*/
];

const tickerPrices = new Map();

const delay = 1000 * tickerArray.length; // 1 second per ticker

fetchTickerPrices(tickerArray, tickerPrices, 100);
setInterval(
  () => fetchTickerPrices(tickerArray, tickerPrices, delay),
  1000 * 60 * 5
);

app.use(
  cors({
    origin: "*",
    optionsSuccessStatus: 200,
  })
);

app.get("/", (req, res) => {
  console.log(tickerPrices.values())
  res.status(200).json(Array.from(tickerPrices.values()));
});

app.listen(3000, "::");
